<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حاسبة الطعام</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            background-color: #f0f0f5;
            color: #333;
            padding: 10px;
            margin: 0;
            font-size: 12px;
        }

        h1, h3 {
            color: #4CAF50;
            text-align: center;
            margin: 10px 0;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            text-align: center;
        }

        input[type="text"], input[type="number"] {
            width: 90%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            text-align: center;
            font-size: 9px;
        }

        button {
            padding: 6px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 10px;
            margin: 3px;
        }

        button:hover {
            background-color: #45a049;
        }

        button.clear-btn {
            background-color: red;
            font-size: 10px;
        }

        button.clear-btn:hover {
            background-color: #d93434;
        }

        button.remove-btn {
            background-color: orange;
            font-size: 10px;
        }

        button.remove-btn:hover {
            background-color: #cc8400;
        }

        button.reset-btn {
            background-color: red;
            font-size: 12px;
            padding: 8px 12px;
        }

        button.reset-btn:hover {
            background-color: #d93434;
        }

        table {
            width: 100%;
            margin: 15px 0;
            border-collapse: collapse;
            background-color: white;
            font-size: 12px;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 6px;
            text-align: center;
        }

        th {
            background-color: #4CAF50;
            color: white;
        }

        td {
            font-size: 12px; /* تنسيق حجم النص ليكون مرئيًا بشكل أفضل */
        }

        ul {
            list-style-type: none;
            padding: 0;
            display: none;
        }

        ul li {
            background-color: #f9f9f9;
            margin: 3px 0;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
        }

        ul li:hover {
            background-color: #e0e0e0;
        }

        .totals-row {
            font-weight: bold;
            background-color: #f0f0f5;
            color: red;
        }

        .notes {
            display: none;
            margin: 10px 0;
            background-color: #f9f9f9;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .toggle-notes {
            cursor: pointer;
            color: #4CAF50;
            text-align: center;
            font-size: 14px;
            text-decoration: underline;
            color: red;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>برنامج حساب الطعام</h1>
    <p style="color: blue;">(اعداد حسام الحديدي)</p>

    <!-- جدول إدخال الحدود -->
    <h3>أدخل احتياجك من الأرقام</h3>
    <table>
        <thead>
        <tr>
            <th>السعرات</th>
            <th>البروتين</th>
            <th>الكارب</th>
            <th>الدهون</th>
            <th>الألياف</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><input type="number" id="calorieLimit" placeholder="السعرات" min="0"></td>
            <td><input type="number" id="proteinLimit" placeholder="البروتين" min="0"></td>
            <td><input type="number" id="carbLimit" placeholder="الكارب" min="0"></td>
            <td><input type="number" id="fatLimit" placeholder="الدهون" min="0"></td>
            <td><input type="number" id="fiberLimit" placeholder="الألياف" min="0"></td>
        </tr>
        </tbody>
    </table>
    <button class="reset-btn" onclick="resetLimits()">تصفير الاحتياج</button> <!-- زر لتصفير الاحتياج -->

    <!-- البحث عن الطعام -->
    <h3>اختار اسم الطعام واكتب تحته الكمية بالغرام</h3>
    <input type="text" id="search" placeholder="اكتب اسم الطعام" oninput="searchFood()">
    <input type="number" id="quantity" value="100" min="1" style="width: 20%;"> <!-- خانة الكمية -->
    <button onclick="addFood()">إدخال</button> <!-- زر إدخال -->
    <ul id="searchResults"></ul>

    <!-- جدول الطعام المختار -->
    <h3>قائمة الأطعمة المختارة</h3>
    <table id="selectedFoodTable">
        <thead>
        <tr>
            <th>اسم الطعام</th>
            <th>الكمية (غرام)</th>
            <th>السعرات الحرارية</th>
            <th>البروتين</th>
            <th>الكارب</th>
            <th>الدهون</th>
            <th>الألياف</th>
            <th>إزالة</th>
        </tr>
        </thead>
        <tbody></tbody>
        <tr class="totals-row">
            <td>المجموع</td>
            <td id="totalWeight">0</td>
            <td id="totalCalories">0</td>
            <td id="totalProtein">0</td>
            <td id="totalCarbs">0</td>
            <td id="totalFats">0</td>
            <td id="totalFiber">0</td>
            <td><button class="clear-btn" onclick="clearTable()">تصفير القائمة</button></td>
        </tr>
    </table>

    <!-- ملاحظات -->
    <div class="toggle-notes" onclick="toggleNotes()">
        <span id="notesArrow">&#x25BC;</span> ملاحظات
    </div>
    <div class="notes" id="notes">
        <p>• التمرة الواحدة تقريباً 30-35 غم</p>
        <p>• احسب كل شيء فهنالك أطعمة صغيرة الحجم وكثيرة السعرات.</p>
    </div>
</div>

<script>
    let selectedFoods = [];

    const foods = [
        { name: 'تفاح', calories: 52, protein: 0.3, carbs: 14, fats: 0.2, fiber: 2.4 },
        { name: 'موز', calories: 89, protein: 1.1, carbs: 23, fats: 0.3, fiber: 2.6 },
        { name: 'دجاج', calories: 239, protein: 27, carbs: 0, fats: 14, fiber: 0 },
        { name: 'رز', calories: 130, protein: 2.7, carbs: 28, fats: 0.3, fiber: 0.4 },
        { name: 'لحم بقر', calories: 250, protein: 26, carbs: 0, fats: 17, fiber: 0 },
        { name: 'سمك', calories: 206, protein: 22, carbs: 0, fats: 12, fiber: 0 },
        { name: 'زبادي', calories: 61, protein: 3.5, carbs: 4.7, fats: 3.3, fiber: 0 },
        // أضف المزيد من الأطعمة هنا
    ];

    function searchFood() {
        const searchValue = document.getElementById('search').value.toLowerCase();
        const searchResults = document.getElementById('searchResults');
        
        if (searchValue === '') {
            searchResults.style.display = 'none';
            searchResults.innerHTML = '';
            return;
        }

        const filteredFoods = foods.filter(food => food.name.includes(searchValue));
        searchResults.innerHTML = '';

        filteredFoods.forEach(food => {
            const li = document.createElement('li');
            li.textContent = food.name;
            li.onclick = function () {
                document.getElementById('search').value = food.name;
                searchResults.innerHTML = '';
                searchResults.style.display = 'none';
            };
            searchResults.appendChild(li);
        });

        searchResults.style.display = 'block';
    }

    function addFood() {
        const foodName = document.getElementById('search').value;
        const quantity = parseFloat(document.getElementById('quantity').value) || 0;

        if (!foodName || quantity <= 0) {
            alert('يرجى إدخال اسم الطعام وكمية صحيحة.');
            return;
        }

        const food = foods.find(f => f.name === foodName);
        
        if (!food) {
            alert('الطعام غير موجود.');
            return;
        }

        selectedFoods.push({ food, quantity });
        updateTable();
    }

    function updateTable() {
        const tbody = document.querySelector('#selectedFoodTable tbody');
        tbody.innerHTML = '';

        let totalCalories = 0;
        let totalProtein = 0;
        let totalCarbs = 0;
        let totalFats = 0;
        let totalFiber = 0;
        let totalWeight = 0;

        selectedFoods.forEach(({ food, quantity }) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${food.name}</td>
                <td>${quantity}</td>
                <td>${(food.calories * quantity / 100).toFixed(2)}</td>
                <td>${(food.protein * quantity / 100).toFixed(2)}</td>
                <td>${(food.carbs * quantity / 100).toFixed(2)}</td>
                <td>${(food.fats * quantity / 100).toFixed(2)}</td>
                <td>${(food.fiber * quantity / 100).toFixed(2)}</td>
                <td><button class="remove-btn" onclick="removeFood('${food.name}')">حذف</button></td>
            `;
            tbody.appendChild(row);

            totalCalories += food.calories * quantity / 100;
            totalProtein += food.protein * quantity / 100;
            totalCarbs += food.carbs * quantity / 100;
            totalFats += food.fats * quantity / 100;
            totalFiber += food.fiber * quantity / 100;
            totalWeight += quantity;
        });

        document.getElementById('totalCalories').textContent = totalCalories.toFixed(2);
        document.getElementById('totalProtein').textContent = totalProtein.toFixed(2);
        document.getElementById('totalCarbs').textContent = totalCarbs.toFixed(2);
        document.getElementById('totalFats').textContent = totalFats.toFixed(2);
        document.getElementById('totalFiber').textContent = totalFiber.toFixed(2);
        document.getElementById('totalWeight').textContent = totalWeight;

        checkLimits(); // استدعاء دالة التحقق
    }

    function removeFood(name) {
        selectedFoods = selectedFoods.filter(item => item.food.name !== name);
        updateTable();
    }

    function clearTable() {
        selectedFoods = [];
        updateTable();
    }

    function toggleNotes() {
        const notes = document.getElementById('notes');
        const notesArrow = document.getElementById('notesArrow');
        if (notes.style.display === 'none') {
            notes.style.display = 'block';
            notesArrow.innerHTML = '&#x25B2;';
        } else {
            notes.style.display = 'none';
            notesArrow.innerHTML = '&#x25BC;';
        }
    }

    // دالة التحقق من تجاوز الحدود
    function checkLimits() {
        const calorieLimit = parseFloat(document.getElementById('calorieLimit').value) || Infinity;
        const proteinLimit = parseFloat(document.getElementById('proteinLimit').value) || Infinity;
        const carbLimit = parseFloat(document.getElementById('carbLimit').value) || Infinity;
        const fatLimit = parseFloat(document.getElementById('fatLimit').value) || Infinity;
        const fiberLimit = parseFloat(document.getElementById('fiberLimit').value) || Infinity;

        const totalCalories = parseFloat(document.getElementById('totalCalories').textContent);
        const totalProtein = parseFloat(document.getElementById('totalProtein').textContent);
        const totalCarbs = parseFloat(document.getElementById('totalCarbs').textContent);
        const totalFats = parseFloat(document.getElementById('totalFats').textContent);
        const totalFiber = parseFloat(document.getElementById('totalFiber').textContent);

        if (totalCalories > calorieLimit) {
            alert('لقد تجاوزت عدد السعرات المطلوب.');
        } 
        if (totalProtein > proteinLimit) {
            alert('لقد تجاوزت غرامات البروتين المطلوب.');
        } 
        if (totalCarbs > carbLimit) {
            alert('لقد تجاوزت عدد الكارب المطلوب.');
        } 
        if (totalFats > fatLimit) {
            alert('لقد تجاوزت عدد الدهون المطلوب.');
        } 
        if (totalFiber > fiberLimit) {
            alert('لقد تجاوزت عدد الألياف المطلوب.');
        }
    }

    // دالة لتصفير الاحتياج
    function resetLimits() {
        document.getElementById('calorieLimit').value = '';
        document.getElementById('proteinLimit').value = '';
        document.getElementById('carbLimit').value = '';
        document.getElementById('fatLimit').value = '';
        document.getElementById('fiberLimit').value = '';
    }
</script>

</body>
</html>
